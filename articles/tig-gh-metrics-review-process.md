---
title: 'tig-ghのメトリクス機能でPRレビュープロセスを可視化・改善する'
emoji: '📊'
type: 'tech'
topics:
  - 'GitHub'
  - 'PR'
  - 'レビュー'
  - 'メトリクス'
  - 'Go'
published: false
publication_name: 'kyash'
---

KyashでBackend Engineering Managerをしている[a1yama](https://x.com/xxx_a1_xxx)です。
この記事は [Kyash Advent Calendar 2025](https://adventar.org/calendars/11602) の5日目の記事です。

## はじめに

チーム開発をしていく上で、PRの書きぶりが人によって違っていたり、PRが長時間放置されたりと、レビュープロセスやリリース頻度に課題を感じることがありました。

GitHubの内容をターミナルで気軽に見れるツールの作成をしていたのですが、上記の課題の解決をしたく、メトリクス機能を追加しました。本記事では、メトリクス機能でレビュープロセスを可視化し、開発フローを改善する方法を紹介します。

## tig-gh

tig-ghは、tigライクな操作感でGitHubを管理できるTUIツールです。Issue、Pull Request、Commitなどをターミナルから快適に操作できます。

https://github.com/a1yama/tig-gh

### 主な特徴

- **tigライクな操作感**: `j`/`k`でリスト移動、`Enter`で詳細表示など、tigユーザーに馴染みのあるキーバインディング
- **複数ビュー対応**: Issues、Pull Requests、Commits、Search、Review Queue、Metricsの各ビュー
- **高速なキャッシュ機構**: GitHub API呼び出し結果のメモリ＋ファイルキャッシュ
- **メトリクス機能**: 複数リポジトリのレビュープロセス分析

本記事では、特に**メトリクス機能**にフォーカスします。

## メトリクス機能の詳細

メトリクスビューは、複数リポジトリのレビュープロセスを多角的に分析し、チームのパフォーマンス改善を支援します。

### 1. Review Phase Breakdown（レビューフェーズ分解）

レビュープロセスを以下のフェーズに分解し、各フェーズの平均所要時間を可視化します。

```
PR作成 → 初回レビュー → 承認 → マージ
```

#### 表示内容

- **Created to First Review**: PR作成から最初のレビューまでの時間
- **First Review to Approval**: 最初のレビューから承認までの時間
- **Approval to Merge**: 承認からマージまでの時間
- **Total Lead Time**: PR作成からマージまでの全体のリードタイム

#### 活用方法

各フェーズの所要時間を比較して、ボトルネックを特定します。
リードタイムの短縮は、マージ頻度の向上、ひいてはリリース頻度の向上に直結します。

**例**:
- 「Created to First Review」が長い → レビュアーアサインの自動化やSlack通知の強化を検討
- 「First Review to Approval」が長い → PRの分割やレビュー観点の明確化を検討
- 「Approval to Merge」が長い → マージ権限の委譲やCI/CDの高速化を検討

### 2. Stagnant PRs（滞留PR）

3日以上オープンになっているPRを「滞留PR」として検出し、放置されているPRを可視化します。

#### 表示内容

- **Total Stagnant**: 滞留PR総数
- **Longest Waiting**: 最も古い滞留PRの情報（リポジトリ、PR番号、経過時間）

#### 活用方法

定期的に確認して、放置PRにアクションを促します。

**例**:
- 毎週月曜日にメトリクスビューで滞留PRを確認
- 1週間以上経過しているPRはチーム会で状況を共有
- 不要になったPRはクローズし、必要なPRはレビュアーを追加

### 3. PR Quality Issues（PRクオリティチェック）

PRの品質に関する問題を自動検出します。

#### 検出項目

- **大規模PR**: 変更行数が多すぎるPR
- **説明不足**: 本文が短すぎるPR
- **レビュアー不足**: レビュアーがアサインされていないPR
- **テンプレート違反**: PRテンプレートに従っていないPR

#### 活用方法

品質問題のあるPRを早期に発見して、改善を促します。

**例**:
- 大規模PRは分割を推奨
- 説明不足のPRには背景や影響範囲の追記を依頼
- レビュアー不足のPRには適切なレビュアーをアサイン

### 4. Day-of-Week Activity（曜日別活動）

曜日ごとのレビュー数とマージ数を可視化します。

#### 表示内容

- **Review Count**: 曜日ごとのレビュー数
- **Merge Count**: 曜日ごとのマージ数

#### 活用方法

曜日パターンを把握して、デプロイ戦略、リリース頻度やレビュー体制を最適化します。

**例**:
- 金曜日のマージが多い → 週末前のマージを避けるルールを検討
- 月曜日のレビューが少ない → 週初めのレビュー促進施策を検討
- 水曜日のマージが多い → リリース日として適切か評価

### 5. Weekly Comparison（週次比較）

今週と先週の主要メトリクスを比較し、増減率を表示します。

#### 表示内容

- **This Week**: 今週のレビュー数・マージ数
- **Last Week**: 先週のレビュー数・マージ数
- **Change Percent**: 増減率（%）

#### 活用方法

週次でメトリクスの変化を追跡して、改善トレンドを確認します。

**例**:
- レビュー数が増加 → レビュー文化が定着している
- マージ数が減少 → 停滞しているPRの調査が必要
- 両方とも増加 → チームの開発速度が向上

### 6. Per Repository（リポジトリ別統計）

各リポジトリの平均リードタイム、中央値、PR数を表示します。

#### 活用方法

リポジトリ間のパフォーマンスを比較して、改善が必要なリポジトリを特定します。

**例**:
- リードタイムが長いリポジトリ → レビュー体制やCI/CDの見直し
- PR数が多いリポジトリ → 開発が活発、または小さすぎるPRが多い可能性
- リードタイムが短いリポジトリ → 良いプラクティスを他リポジトリに展開

## 設定方法

メトリクス機能を使用するには、設定ファイルで対象リポジトリと計測期間を指定します。

```yaml:config.yaml
github:
  token: ghp_xxxxxxxxxxxx
  repositories:
    - your-org/repo1
    - your-org/repo2
    - your-org/repo3

metrics:
  enabled: true
  lead_time_enabled: true
  calculation_period: 720h  # 30日間（720h=30日, 2160h=90日）
  show_review_phases: true
  show_day_of_week: true
  show_weekly_comparison: true
  show_quality_issues: true
  show_stagnant_prs: true
  show_repository_stats: true
```

## まとめ

tig-ghのメトリクス機能を活用することで、以下のような効果が期待できます。

1. **レビュープロセスの可視化**: どこがボトルネックかを定量的に把握
2. **滞留PRの早期発見**: 放置されているPRを定期的に確認
3. **PR品質の向上**: 大規模PRや説明不足PRを自動検出
4. **曜日パターンの把握**: デプロイ戦略やレビュー体制の最適化
5. **継続的な改善**: 週次比較で改善トレンドを追跡

メトリクスは「測定すること」が目的ではなく、「改善すること」が目的です。tig-ghのメトリクス機能を使って、チームのレビュープロセスを継続的に改善していきましょう。

## おわりに

ターミナルからサクサクとGitHubを操作しながら、チームのメトリクスを確認できるtig-ghを、ぜひお試しください。

個人開発でありながらKyashのバックエンドに合わせた要件定義にしているため、万人向けを想定してはいません。チームメンバーからは「計測ブランチを絞りたい」「もっと気軽に見れるようにしたい」といった意見をもらっており、改善を進めています。今後はメトリクスの定期Slack通知なども検討中です。

チーム定例でもこのツールを使ってPRの整理や状態の確認を行い、レビュープロセスの最適化とリリース頻度の向上を目指しています。

フィードバックやコントリビューションをお待ちしています！

https://github.com/a1yama/tig-gh

ご質問やフィードバックがあれば、GitHubのIssueやXでお気軽にご連絡ください。

それでは、良いレビューライフを！
